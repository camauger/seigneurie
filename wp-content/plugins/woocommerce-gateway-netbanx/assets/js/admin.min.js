!function(e){var a={init:function(){this.moveRefundInfoAfterTable()},moveRefundInfoAfterTable:function(){var a=e("#woocommerce-order-items").find(".wc-paysafe-refund-info");e(".wc-order-refund-items").not(".wc-paysafe-refund-info").find("table.wc-order-totals").after(a)}},t={init:function(){e(".woocommerce_page_wc-settings").on("change","#woocommerce_netbanx_integration",this.loadIntegrationSettings),this.triggerIntegrationChange(),this.onSettingsChanges(),this.onIframeSettingsChange(),void 0!==e(".repeater-field")&&this.initRepeaterFields()},integrationType:function(){return e("#woocommerce_netbanx_integration").val()},triggerIntegrationChange:function(){e(".woocommerce_page_wc-settings #woocommerce_netbanx_integration").change()},onSettingsChanges:function(){e("#woocommerce_netbanx_saved_cards").on("change",this.showHideSaveCustomersSettings).change()},onIframeSettingsChange:function(){e("#woocommerce_netbanx_use_iframe").on("change",this.showHideIframeSettings).change()},showHideSaveCustomersSettings:function(a){var n=e(a.target),r=t.integrationType(),i=e(".show_if_"+r+"_saved_cards"),o=i.closest("tr");n.is(":checked")?(o.show(),i.show()):(o.hide(),i.hide())},showHideIframeSettings:function(a){var n=e(a.target),r=t.integrationType(),i=e(".show_if_"+r+"_use_iframe"),o=i.closest("tr");n.is(":checked")?(o.show(),i.show()):(o.hide(),i.hide())},loadIntegrationSettings:function(a){if(void 0!==e("#woocommerce_netbanx_general_settings_start")){var t=e(a.target),n=t.val(),r=t.data("initial-type"),i=[],o=[],c=e(".paysafe_warning");c.html(wc_paysafe_params.il8n_integration_changed),c.hide(),n!==r?((i=e(".integration_"+r)).hide(),i.closest("tr").hide(),c.show()):((o=e(".integration_"+r)).show(),o.closest("tr").show(),c.hide())}},initRepeaterFields:function(){e(".repeater-field-wrap").on("click",".paysafe-remove-account-id",function(){var a=e(this).closest(".repeater-field-wrap").data("id"),t=e("."+a+"-repeater-field-wrap").find(".repeater-field").not(".template-fieldset").length,n=e(this).closest(".repeater-field");1<parseInt(t)&&window.confirm(wc_paysafe_params.il8n_confirm_pair_removal)&&n.remove()}).on("click",".paysafe-add-account-id",function(){var a=e(this).closest(".repeater-field-wrap").data("id"),t=e("."+a+"-repeater-field-wrap"),n=t.find(".repeater-field").not(".template-fieldset"),r=t.find(".repeater-field.template-fieldset"),i=n.last(),o=[];n.each(function(){o.push(e(this).data("field-key"))});var c=o.reduce(function(e,a){return Math.max(e,a)}),s=r.clone(),p=a+"_account_currency",f=a+"_account_id";s.html(function(e,a){var t=a.replace(new RegExp("{number}","g"),parseInt(c)+1);return t=(t=t.replace(new RegExp("{"+p+"}","g"),p)).replace(new RegExp("{"+f+"}","g"),f)}),s.find(".enhanced").removeClass("enhanced"),s.removeClass("template-fieldset"),s.data("field-key",parseInt(c)+1),s.show(),s.insertAfter(i),e("body").trigger("wc-enhanced-select-init")})}};({init:function(){e("#woocommerce-order-items").on("click","button.wc-paysafe-capture-payment-init",this.initOrderCapture).on("click","button.wc-paysafe-capture-cancel",this.cancelOrderCapture).on("click","button.wc-paysafe-capture-payment",this.processCapture)},initOrderCapture:function(){e(".wc-paysafe-capture-payment-wrapper").show(),e(".wc-paysafe-capture-allowed-amount-wrapper").show(),e(".wc-paysafe-capture-amount-wrapper").show(),e(".wc-paysafe-capture-cancel").show(),e("button.wc-paysafe-capture-payment-init").hide()},cancelOrderCapture:function(){e(".wc-paysafe-capture-payment-wrapper").hide(),e(".wc-paysafe-capture-allowed-amount-wrapper").hide(),e(".wc-paysafe-capture-amount-wrapper").hide(),e(".wc-paysafe-capture-cancel").hide(),e("button.wc-paysafe-capture-payment-init").show()},processCapture:function(){var a=e("#woocommerce-order-items");if(a.block(),!window.confirm(wc_paysafe_params.i18n_capture_payment))return a.unblock(),!1;var t=e(".wc-paysafe-capture-amount-wrapper input.wc-paysafe-capture-amount").val();if(""===t)return a.unblock(),!1;var n={action:"wc_paysafe_capture_payment",order_id:woocommerce_admin_meta_boxes.post_id,capture_amount:t,security:wc_paysafe_params.capture_payment};e.post(wc_paysafe_params.ajax_url,n,function(e){!0===e.success?(window.alert(e.data.message),window.location.href=window.location.href):(window.alert(e.data.message),a.unblock())})}}).init(),a.init(),t.init()}(jQuery);